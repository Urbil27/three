<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mostrar modelo 3D </title>
    <script src="node_modules\three\build\three.min.js"></script>
    <script src="node_modules\three\examples\js\loaders\GLTFLoader.js"></script>
    <script src="node_modules\three\examples\js\controls\OrbitControls.js"></script>
    <script type="text/javascript" src="http://static.robotwebtools.org/EventEmitter2/current/eventemitter2.js"></script>
    <script type="text/javascript" src="http://static.robotwebtools.org/roslibjs/current/roslib.js"></script>
 
</head>
<body>
  <button onclick="alante()">Alante</button>
  <button onclick="derecha()">Derecha</button>
  <button onclick="izquierda()">Izquierda</button>
  <button onclick="atras()">Atras</button>
    <script src="js/3d.js"></script>
    <script>
        var rotationDegrees = 0;
        var direccion = 0;
        var xSpeed = 1;
        var ySpeed = 1;

        //Funci贸n que se ejecuta para mover el objeto hacia delante
        function alante(){
        console.log("alante");
        console.log("rotationDegrees "+ rotationDegrees);

        if(rotationDegrees == 0){
            console.log("if 1");
            direccion++;
            spider.position.z += 1;
        }

        else if(rotationDegrees > 0 && rotationDegrees < 90){
            console.log("if 2");
            direccion++;
            spider.position.x -= 1;
            spider.position.z += 1;
        }
        
        else if(rotationDegrees == 90){
            console.log("if 1");
            direccion++;
            spider.position.x += 1;
        }
        else if(rotationDegrees > 90 && rotationDegrees < 180){
            console.log("if 3");
            direccion++;
            spider.position.x -= 1;
            spider.position.z -= 1;
        }
        else if(rotationDegrees == 180){
            console.log("if 4");
            direccion++;
            spider.position.z -= 1;
        }

        else if(rotationDegrees > 180 && rotationDegrees < 270){
            console.log("if 5");
            direccion --;
            spider.position.x += 1;
            spider.position.z -= 1;
        }

        else if(rotationDegrees == 270){
            console.log("if 4");
            direccion++;
            spider.position.x -= 1;
        }

        else if(rotationDegrees > 270 && rotationDegrees < 360){
            console.log("if 6");
            direccion --;
            spider.position.x += 1;
            spider.position.z += 1;
        }

        else if(rotationDegrees < 0 && rotationDegrees > -90){
            console.log("if 7");
            direccion++;
            spider.position.x += 1;
            spider.position.z += 1;
        }
        else if(rotationDegrees == -90){
            console.log("if 1");
            direccion++;
            spider.position.x += 1;
        }
        else if(rotationDegrees < -90 && rotationDegrees > -180){
            console.log("if 8");
            direccion++;
            spider.position.x += 1;
            spider.position.z -= 1;
        }

        else if(rotationDegrees == -180){
            console.log("if 9");
            direccion++;
            spider.position.z -= 1;
        }

        else if(rotationDegrees < -180 && rotationDegrees > -270){
            console.log("if 10");
            direccion --;
            spider.position.x -= 1;
            spider.position.z -= 1;
        }

        else if(rotationDegrees == -270){
            console.log("if 9");
            direccion++;
            spider.position.x -= 1;
        }

        else if(rotationDegrees < -270 && rotationDegrees > -360){
            console.log("if 11");
            direccion --;
            spider.position.x -= 1;
            spider.position.z += 1;
        }
    }   
        //Funci贸n que se ejecuta para mover el objeto hacia atras
        function atras(){ 
        
            if(rotationDegrees == 0){
            console.log("if 1");
            direccion++;
            spider.position.z -= 1;
        }

        else if(rotationDegrees > 0 && rotationDegrees < 90){
            console.log("if 2");
            direccion++;
            spider.position.x += 1;
            spider.position.z -= 1;
        }
        
        else if(rotationDegrees == 90){
            console.log("if 1");
            direccion++;
            spider.position.x -= 1;
        }
        else if(rotationDegrees > 90 && rotationDegrees < 180){
            console.log("if 3");
            direccion++;
            spider.position.x += 1;
            spider.position.z += 1;
        }
        else if(rotationDegrees == 180){
            console.log("if 4");
            direccion++;
            spider.position.z += 1;
        }

        else if(rotationDegrees > 180 && rotationDegrees < 270){
            console.log("if 5");
            direccion --;
            spider.position.x -= 1;
            spider.position.z += 1;
        }

        else if(rotationDegrees == 270){
            console.log("if 4");
            direccion++;
            spider.position.x += 1;
        }

        else if(rotationDegrees > 270 && rotationDegrees < 360){
            console.log("if 6");
            direccion --;
            spider.position.x -= 1;
            spider.position.z -= 1;
        }

        else if(rotationDegrees < 0 && rotationDegrees > -90){
            console.log("if 7");
            direccion++;
            spider.position.x -= 1;
            spider.position.z -= 1;
        }
        else if(rotationDegrees == -90){
            console.log("if 1");
            direccion++;
            spider.position.x -= 1;
        }
        else if(rotationDegrees < -90 && rotationDegrees > -180){
            console.log("if 8");
            direccion++;
            spider.position.x -= 1;
            spider.position.z += 1;
        }

        else if(rotationDegrees == -180){
            console.log("if 9");
            direccion++;
            spider.position.z += 1;
        }

        else if(rotationDegrees < -180 && rotationDegrees > -270){
            console.log("if 10");
            direccion --;
            spider.position.x += 1;
            spider.position.z += 1;
        }

        else if(rotationDegrees == -270){
            console.log("if 9");
            direccion++;
            spider.position.x += 1;
        }

        else if(rotationDegrees < -270 && rotationDegrees > -360){
            console.log("if 11");
            direccion --;
            spider.position.x += 1;
            spider.position.z -= 1;
        }
        }

        //Funci贸n que se ejecuta para rotar hacia la izquierda
        function izquierda(){
            rotationDegrees --;
            rotateObject(spider,0,1,0); 

            if(rotationDegrees==360){
                rotationDegrees = 0;
            }  
            if(rotationDegrees== -360){
                rotationDegrees = 0;
            }           

        }

        //Funci贸n que se ejecuta para rotar hacia la 
        function derecha(){
            rotationDegrees ++;

            if(rotationDegrees==360){
                rotationDegrees = 0;
            }  
            if(rotationDegrees== -360){
                rotationDegrees = 0;
            }    

            rotateObject(spider,0,-1,0);
        }
      


document.addEventListener("keydown", onDocumentKeyDown, false);
function onDocumentKeyDown(event) {
    var keyCode = event.which;
    if (keyCode == 87) {
        console.log("test");
        spider.position.y += ySpeed;
    } else if (keyCode == 83) {
        console.log("test");
        spider.position.y -= ySpeed;
    } else if (keyCode == 65) {
        console.log("test");
        spider.position.x -= xSpeed;
    } else if (keyCode == 68) {
        console.log("test");
        spider.position.x += xSpeed;
    } else if (keyCode == 32) {
        console.log("test");
        spider.position.set(0, 0, 0);
    }
    };
    </script>
    <script>
         var ros = new ROSLIB.Ros({
            url: 'ws://127.0.0.1:9090'
        });
        var listener = new ROSLIB.Topic({
        ros : ros,
        name : '/turtle1/cmd_vel',
        messageType : 'geometry_msgs/Twist'
        });
        listener.subscribe(function(message) {
            console.log('Received message on ' + listener.name + ': ' + message.linear.x + " | "+ message.linear.y);
            if(message.linear.x>0){
                alante();
            }
            else if(message.linear.x<0){
                atras();
            }
            if(message.angular.z>0){
                izquierda();
            }
            else if(message.angular.z<0){
                derecha();
            }
        });
    </script>
    
</body>
</html>